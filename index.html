<!DOCTYPE html>
<html lang="de" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dashboard</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè†</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --bg-color: #f9fafb;
            --text-color-light: #6b7280;
            --header-text-color: #111827;
            --sidebar-bg: #f3f4f6cc;
            --sidebar-border: #e5e7eb;
            --modal-bg: #ffffff;
            --accent-color: #7c3aed;
            --accent-color-hover: #8b5cf6;
            --sidebar-link-active-bg: #7c3aed;
        }

        html[data-theme='dark'] {
            --bg-color: #171717;
            --text-color-light: #a3a3a3;
            --header-text-color: #fafafa;
            --sidebar-bg: #262626cc;
            --sidebar-border: #404040;
            --modal-bg: #262626;
            --accent-color: #7c3aed;
            --accent-color-hover: #8b5cf6;
            --sidebar-link-active-bg: #7c3aed;
        }

        html,
        body {
            height: 100%;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color-light);
            overflow: hidden;
        }

        /* Haupt-Inhaltsbereich relativ positioniert f√ºr den Loader */
        #main-content {
            position: relative;
        }

        /* Lade-Abdeckung f√ºr den Iframe-Wechsel */
        #content-loader {
            position: absolute;
            inset: 0;
            background-color: var(--bg-color);
            z-index: 10;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            /* Klicks durchlassen, wenn unsichtbar */
        }

        #content-loader.hidden {
            opacity: 0;
        }

        #content-frame {
            transition: opacity 0.3s ease-in-out;
        }


        /* Desktop Sidebar: Bleibt fixiert, Hover-Effekt wie bisher */
        #sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 50;
            width: 5rem;
            transition: width 0.3s;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--sidebar-border);
            backdrop-filter: blur(8px);
            display: flex;
            /* Flexbox hinzugef√ºgt */
            flex-direction: column;
            /* Anordnung in Spalte */
            justify-content: space-between;
            /* Elemente oben und unten ausrichten */
        }

        #sidebar:hover {
            width: 16rem;
        }

        .sidebar-text {
            opacity: 0;
            max-width: 0;
            transition: opacity 0.2s ease, max-width 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            margin-left: 0.75rem;
        }

        #sidebar:hover .sidebar-text {
            opacity: 1;
            max-width: 150px;
        }

        .sidebar-link {
            color: var(--text-color-light);
        }

        .sidebar-link:hover {
            background-color: var(--accent-color-hover);
            color: #ffffff;
        }

        .sidebar-link.active {
            background-color: var(--sidebar-link-active-bg);
            color: #ffffff;
        }

        /* Styling for the new SVG icon */
        .sidebar-link svg .st0 {
            /* We set fill to currentColor, but the path also uses a stroke for the outlines */
            fill: none;
            /* Make sure the path is not filled if we want only a stroke */
            stroke: currentColor;
            /* Inherit color from parent for the SVG stroke */
            stroke-width: 0.5;
            /* Adjust this value to make the stroke thicker or thinner */
        }

        /* Copyright Text */
        .copyright-text {
            opacity: 0;
            max-width: 0;
            transition: opacity 0.2s ease, max-width 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            margin-left: 0.75rem;
            color: var(--text-color-light);
            text-align: center;
            padding-bottom: 1rem;
            /* Abstand vom unteren Rand */
        }

        #sidebar:hover .copyright-text {
            opacity: 1;
            max-width: 150px;
        }

        /* Mobile Header */
        #mobile-header {
            background-color: var(--sidebar-bg);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--sidebar-border);
        }

        /* Mobile Menu Panel */
        #mobile-menu {
            background-color: var(--bg-color);
            border-right: 1px solid var(--sidebar-border);
        }

        #mobile-menu.open {
            transform: translateX(0);
        }

        #settings-modal {
            background-color: var(--modal-bg);
            z-index: 100;
        }

        .theme-radio-label {
            border: 2px solid var(--sidebar-border);
            color: var(--text-color-light);
            transition: background-color 0.2s, color 0.2s;
        }

        .theme-radio-label:hover {
            background-color: var(--sidebar-border);
            color: var(--header-text-color);
        }

        .theme-radio-peer:checked~.theme-radio-label {
            border-color: var(--accent-color);
            color: var(--header-text-color);
            background-color: transparent;
        }

        .theme-radio-peer:checked~.theme-radio-label:hover {
            background-color: var(--sidebar-border);
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<body data-theme="system">

    <!-- Mobile Header (wird auf md und gr√∂sser versteckt) -->
    <header id="mobile-header" class="md:hidden fixed top-0 left-0 right-0 z-40 flex items-center justify-between p-4">
        <span id="mobile-header-title" class="font-bold text-lg"
            style="color: var(--header-text-color);">Appdrawer</span>
        <button id="hamburger-btn" class="p-1">
            <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
        </button>
    </header>

    <!-- Sidebar Navigation (wird auf kleinen Bildschirmen versteckt) -->
    <nav id="sidebar" class="hidden md:flex flex-col p-2">
        <ul id="nav-links" class="space-y-2 mt-2">
            <li><a href="appdrawer.html" class="sidebar-link flex items-center p-3 rounded-lg active"><svg
                        class="w-8 h-8 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 8.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25A2.25 2.25 0 0 1 8.25 21H6a2.25 2.25 0 0 1-2.25-2.25v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25h2.25A2.25 2.25 0 0 1 20.25 6v2.25a2.25 2.25 0 0 1-2.25 2.25h-2.25A2.25 2.25 0 0 1 13.5 8.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25h2.25a2.25 2.25 0 0 1 2.25 2.25v2.25a2.25 2.25 0 0 1-2.25 2.25h-2.25a2.25 2.25 0 0 1-2.25-2.25v-2.25Z" />
                    </svg><span class="sidebar-text font-medium">Appdrawer</span></a></li>
            <li><a href="unicorn/work-tools.html" target="_blank" rel="noopener noreferrer"
                    class="sidebar-link flex items-center p-3 rounded-lg">
                    <svg height="27px" width="27px" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15.36 15.36" xml:space="preserve">
                        <style type="text/css">
                            .st0 {
                                fill: none;
                                stroke: currentColor;
                                stroke-width: 0.5;
                            }
                        </style>
                        <g>
                            <path class="st0" d="M10.48 6.65a0.507 0.507 0 1 0 0 1.013 0.507 0.507 0 0 0 0 -1.013" />
                            <path class="st0"
                                d="m14.883 7.739 -2.251 -1.948 1.223 -3.18 0.001 -0.002h0a0.48 0.48 0 0 0 0.031 -0.167 0.476 0.476 0 0 0 -0.224 -0.404 0.474 0.474 0 0 0 -0.252 -0.072h-0.002c-0.001 0 -0.001 0 -0.001 0a0.474 0.474 0 0 0 -0.347 0.153l-2.077 2.245 -0.552 -0.477 -0.516 -1.308a0.605 0.605 0 0 0 -0.502 -0.38 0.5 0.5 0 0 0 -0.061 -0.003 0.605 0.605 0 0 0 -0.509 0.278L7.729 4.206c-0.443 0.171 -0.88 0.269 -1.284 0.389h0c-0.217 0.066 -0.427 0.139 -0.622 0.242 -0.194 0.104 -0.376 0.241 -0.518 0.429h0a1.07 1.07 0 0 0 -0.171 0.326 1.07 1.07 0 0 0 -0.048 0.321v0.001c0.001 0.171 0.034 0.321 0.061 0.449l0 0.001c0.027 0.127 0.048 0.236 0.048 0.322v0.003c0 0.052 -0.006 0.095 -0.02 0.139 -0.014 0.045 -0.035 0.089 -0.076 0.142 -0.038 0.05 -0.071 0.08 -0.106 0.104l0 0c-0.059 0.04 -0.122 0.061 -0.216 0.075l0 0c-0.068 0.01 -0.151 0.014 -0.243 0.018h0c-0.138 0.007 -0.304 0.012 -0.484 0.069h0c-0.09 0.029 -0.182 0.071 -0.27 0.133a1.06 1.06 0 0 0 -0.242 0.235l-0.003 0.004 0.003 -0.004a1.07 1.07 0 0 0 -0.171 0.326 1.07 1.07 0 0 0 -0.048 0.321v0.002c0 0.172 0.034 0.321 0.061 0.449l0 0.001c0.027 0.126 0.048 0.236 0.048 0.321v0.003c0 0.052 -0.006 0.095 -0.02 0.139h0c-0.014 0.044 -0.035 0.088 -0.076 0.142h0c-0.038 0.049 -0.071 0.08 -0.105 0.104l-0.001 0.001c-0.059 0.04 -0.122 0.06 -0.214 0.074h0c-0.068 0.01 -0.151 0.014 -0.243 0.017h0c-0.138 0.007 -0.304 0.012 -0.484 0.069h0c-0.09 0.029 -0.182 0.071 -0.27 0.132l0.008 -0.005 -0.008 0.005a1.07 1.07 0 0 0 -0.242 0.235l0 0a1.08 1.08 0 0 0 -0.171 0.327 1.07 1.07 0 0 0 -0.048 0.321v0.002c0.001 0.172 0.034 0.321 0.061 0.449l0 0c0.027 0.127 0.048 0.236 0.048 0.322v0.003c0 0.052 -0.006 0.095 -0.02 0.14 -0.014 0.044 -0.035 0.088 -0.075 0.142l0 0c-0.079 0.103 -0.167 0.168 -0.283 0.231 -0.086 0.046 -0.186 0.088 -0.296 0.135l0 0c-0.163 0.071 -0.355 0.156 -0.529 0.316a1.17 1.17 0 0 0 -0.232 0.295q-0.098 0.175 -0.149 0.404L0 13.394h9.456l1.137 -2.877 2.519 0.501 0.001 -0.003c0.071 0.011 0.143 0.019 0.213 0.019a1.381 1.381 0 0 0 1.105 -0.552l0.653 -0.871a1.377 1.377 0 0 0 0.276 -0.828v-0.001c0 -0.387 -0.164 -0.772 -0.477 -1.044m-1.629 -5.046 -0.387 1.006 -0.441 -0.111zm-1.063 1.15 0.567 0.142 -0.179 0.466 -0.737 -0.23zm-0.578 0.625 0.856 0.267 -0.293 0.762 -0.841 -0.728zm-9.358 8.395H0.707a0.65 0.65 0 0 1 0.184 -0.201c0.064 -0.046 0.138 -0.085 0.223 -0.125 0.127 -0.058 0.277 -0.114 0.432 -0.197 0.155 -0.084 0.316 -0.199 0.449 -0.375a1 1 0 0 0 0.159 -0.304 0.99 0.99 0 0 0 0.044 -0.299c0 -0.162 -0.032 -0.306 -0.059 -0.434 -0.028 -0.129 -0.05 -0.242 -0.049 -0.34 0 -0.058 0.007 -0.11 0.023 -0.162a0.54 0.54 0 0 1 0.088 -0.165 0.53 0.53 0 0 1 0.123 -0.12c0.071 -0.049 0.148 -0.073 0.247 -0.088 0.074 -0.011 0.159 -0.015 0.251 -0.018 0.139 -0.007 0.297 -0.012 0.465 -0.065a0.94 0.94 0 0 0 0.25 -0.122 0.99 0.99 0 0 0 0.224 -0.218 1 1 0 0 0 0.159 -0.304 0.99 0.99 0 0 0 0.044 -0.299c0 -0.162 -0.032 -0.306 -0.059 -0.434 -0.027 -0.129 -0.05 -0.242 -0.049 -0.34 0 -0.058 0.007 -0.11 0.023 -0.163 0.017 -0.052 0.043 -0.105 0.088 -0.165a0.54 0.54 0 0 1 0.123 -0.121c0.071 -0.048 0.148 -0.073 0.247 -0.088 0.074 -0.011 0.158 -0.015 0.251 -0.018 0.139 -0.007 0.297 -0.012 0.464 -0.065a0.92 0.92 0 0 0 0.25 -0.122 0.99 0.99 0 0 0 0.225 -0.219 1 1 0 0 0 0.159 -0.304 0.99 0.99 0 0 0 0.044 -0.299c0 -0.162 -0.032 -0.306 -0.059 -0.434 -0.028 -0.129 -0.05 -0.242 -0.049 -0.34 0 -0.058 0.007 -0.11 0.023 -0.163 0.017 -0.052 0.042 -0.105 0.087 -0.165 0.087 -0.115 0.199 -0.203 0.344 -0.281 0.217 -0.116 0.508 -0.201 0.844 -0.292a20.4 20.4 0 0 0 0.466 -0.13zm12.404 -3.571 -0.653 0.87a0.848 0.848 0 0 1 -0.862 0.32l-0.001 0 -2.88 -0.572 -1.168 2.953H2.796l6.529 -10.156 -0.035 0.055a0.073 0.073 0 0 1 0.062 -0.034l0.006 0 0.002 0a0.074 0.074 0 0 1 0.061 0.046l0.564 1.429 4.55 3.938a0.847 0.847 0 0 1 0.293 0.642 0.845 0.845 0 0 1 -0.17 0.509" />
                        </g>
                    </svg>
                    <span class="sidebar-text font-medium">Unicorn</span>
                </a></li>
            <li><a href="widgets/widgets-iframe.html" class="sidebar-link flex items-center p-3 rounded-lg"><svg
                        class="w-8 h-8 flex-shrink-0" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M2 12C2 10.1308 2 9.19615 2.40192 8.5C2.66523 8.04394 3.04394 7.66523 3.5 7.40192C4.19615 7 5.13077 7 7 7H17C18.8692 7 19.8038 7 20.5 7.40192C20.9561 7.66523 21.3348 8.04394 21.5981 8.5C22 9.19615 22 10.1308 22 12C22 13.8692 22 14.8038 21.5981 15.5C21.3348 15.9561 20.9561 16.3348 20.5 16.5981C19.8038 17 18.8692 17 17 17H7C5.13077 17 4.19615 17 3.5 16.5981C3.04394 16.3348 2.66523 15.9561 2.40192 15.5C2 14.8038 2 13.8692 2 12Z"
                            stroke="currentColor" stroke-width="1.5" />
                        <path d="M19 4C19 2.89543 18.1046 2 17 2H7C5.89543 2 5 2.89543 5 4" stroke="currentColor"
                            stroke-width="1.5" />
                        <path d="M19 20C19 21.1046 18.1046 22 17 22H7C5.89543 22 5 21.1046 5 20" stroke="currentColor"
                            stroke-width="1.5" />
                        <rect x="5.5" y="10.5" width="5" height="1" rx="0.5" stroke="currentColor" />
                    </svg><span class="sidebar-text font-medium">Widgets</span></a></li>
            <li><button id="settings-btn" class="sidebar-link w-full flex items-center p-3 rounded-lg"><svg
                        class="w-8 h-8 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                    </svg><span class="sidebar-text font-medium">Einstellungen</span></button></li>
        </ul>
        <!-- Copyright Text -->
        <div class="copyright-text">
            <span>&copy; dev0gig</span>
        </div>
    </nav>

    <!-- Mobile Menu Panel -->
    <div id="mobile-menu-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
    <nav id="mobile-menu"
        class="fixed top-0 left-0 h-full w-72 z-50 transform -translate-x-full transition-transform duration-300 ease-in-out p-4">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold" style="color: var(--header-text-color);">Men√º</h2>
            <button id="close-mobile-menu-btn" class="p-1">
                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <ul id="mobile-nav-links" class="space-y-2">
            <!-- Mobile links werden hier via JS eingef√ºgt -->
        </ul>
        <!-- Copyright Text f√ºr Mobile (optional, je nach Designwunsch) -->
        <div class="absolute bottom-4 left-0 w-full text-center text-sm" style="color: var(--text-color-light);">
            <span>&copy; Copyright dev0gig</span>
        </div>
    </nav>

    <!-- Iframe Content Area -->
    <main id="main-content" class="h-full pt-20 md:pt-0 md:ml-20">
        <div id="content-loader"></div>
        <iframe id="content-frame" src="./appdrawer.html" class="w-full h-full border-0"></iframe>
    </main>

    <!-- Settings Modal -->
    <div id="modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50"></div>
    <div id="settings-modal"
        class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md rounded-lg shadow-2xl p-6 z-[60]">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold" style="color: var(--header-text-color);">Einstellungen</h2>
            <button id="close-modal-btn" class="hover:text-white text-2xl"
                style="color: var(--text-color-light);">&times;</button>
        </div>
        <div>
            <h3 class="text-lg font-semibold mb-3" style="color: var(--header-text-color);">Erscheinungsbild</h3>
            <fieldset class="space-y-3">
                <legend class="sr-only">Theme selection</legend>
                <div><input type="radio" name="theme" id="theme-light" value="light"
                        class="theme-radio-peer hidden"><label for="theme-light"
                        class="theme-radio-label block w-full p-3 text-center rounded-lg cursor-pointer">Light</label>
                </div>
                <div><input type="radio" name="theme" id="theme-dark" value="dark"
                        class="theme-radio-peer hidden"><label for="theme-dark"
                        class="theme-radio-label block w-full p-3 text-center rounded-lg cursor-pointer">Dark</label>
                </div>
                <div><input type="radio" name="theme" id="theme-system" value="system"
                        class="theme-radio-peer hidden"><label for="theme-system"
                        class="theme-radio-label block w-full p-3 text-center rounded-lg cursor-pointer">System</label>
                </div>
            </fieldset>
        </div>
    </div>

    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', () => {
            const iframe = document.getElementById('content-frame');
            const contentLoader = document.getElementById('content-loader');

            // --- Desktop Sidebar ---
            const desktopNavLinks = document.querySelectorAll('#nav-links > li > a, #nav-links > li > button');

            // --- Mobile Menu ---
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            const closeMobileMenuBtn = document.getElementById('close-mobile-menu-btn');
            const mobileNavLinksContainer = document.getElementById('mobile-nav-links');
            const mobileHeaderTitle = document.getElementById('mobile-header-title');

            // --- Settings Modal ---
            const settingsModal = document.getElementById('settings-modal');
            const modalOverlay = document.getElementById('modal-overlay');
            const closeModalBtn = document.getElementById('close-modal-btn');

            const openMobileMenu = () => {
                mobileMenu.classList.add('open');
                mobileMenuOverlay.classList.remove('hidden');
            };

            const closeMobileMenu = () => {
                mobileMenu.classList.remove('open');
                mobileMenuOverlay.classList.add('hidden');
            };

            const openSettingsModal = () => {
                settingsModal.classList.remove('hidden');
                modalOverlay.classList.remove('hidden');
            };

            const closeSettingsModal = () => {
                settingsModal.classList.add('hidden');
                modalOverlay.classList.add('hidden');
            };

            function updateActiveLink(targetHref) {
                document.querySelectorAll('#nav-links a, #mobile-nav-links a').forEach(l => {
                    if (l.target === '_blank') {
                        l.classList.remove('active');
                        return;
                    }
                    if (new URL(l.href).pathname === new URL(targetHref).pathname) {
                        l.classList.add('active');
                    } else {
                        l.classList.remove('active');
                    }
                });
                const activeLink = document.querySelector(`a.active`);
                if (activeLink) {
                    mobileHeaderTitle.textContent = activeLink.querySelector('span').textContent;
                }
            }

            function handleNavLinkClick(e) {
                const target = e.currentTarget;

                if (target.getAttribute('target') === '_blank') {
                    if (mobileMenu.classList.contains('open')) closeMobileMenu();
                    return;
                }

                e.preventDefault();

                if (target.id.includes('settings-btn')) {
                    openSettingsModal();
                } else {
                    const href = target.href;
                    if (new URL(iframe.src).pathname === new URL(href).pathname) {
                        if (mobileMenu.classList.contains('open')) closeMobileMenu();
                        return;
                    }

                    contentLoader.classList.remove('hidden'); // Loader sofort anzeigen
                    iframe.src = href; // Quelle √§ndern
                    updateActiveLink(href);
                }

                if (mobileMenu.classList.contains('open')) closeMobileMenu();
            }

            // Links f√ºr Mobile-Men√º klonen
            desktopNavLinks.forEach(link => {
                const li = document.createElement('li');
                const newLink = link.cloneNode(true);
                // Entfernen Sie die 'sidebar-text' Klasse, da sie nur f√ºr Desktop-Hover-Effekte relevant ist
                const sidebarTextSpan = newLink.querySelector('.sidebar-text');
                if (sidebarTextSpan) {
                    sidebarTextSpan.classList.remove('sidebar-text');
                }
                newLink.classList.add('w-full');
                li.appendChild(newLink);
                mobileNavLinksContainer.appendChild(li);
                newLink.addEventListener('click', handleNavLinkClick);
            });

            desktopNavLinks.forEach(link => link.addEventListener('click', handleNavLinkClick));

            hamburgerBtn.addEventListener('click', openMobileMenu);
            closeMobileMenuBtn.addEventListener('click', closeMobileMenu);
            mobileMenuOverlay.addEventListener('click', closeMobileMenu);

            closeModalBtn.addEventListener('click', closeSettingsModal);
            modalOverlay.addEventListener('click', (e) => {
                if (!settingsModal.classList.contains('hidden')) closeSettingsModal();
            });

            // --- Theme Wechsler ---
            const themeRadios = document.querySelectorAll('input[name="theme"]');
            function applyTheme(theme) {
                let effectiveTheme;
                if (theme === 'system') {
                    effectiveTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                } else {
                    effectiveTheme = theme;
                }
                document.documentElement.dataset.theme = effectiveTheme;
                if (iframe.contentWindow) iframe.contentWindow.postMessage(`set-theme-${effectiveTheme}`, '*');
            }
            function handleThemeChange(event) {
                const selectedTheme = event.target.value;
                localStorage.setItem('theme', selectedTheme);
                applyTheme(selectedTheme);
            }

            themeRadios.forEach(radio => radio.addEventListener('change', handleThemeChange));
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                const savedTheme = localStorage.getItem('theme') || 'system';
                if (savedTheme === 'system') applyTheme('system');
            });

            // Iframe 'load' Event Listener
            iframe.addEventListener('load', () => {
                const savedTheme = localStorage.getItem('theme') || 'system';
                const themeRadio = document.querySelector(`input[name="theme"][value="${savedTheme}"]`);
                if (themeRadio) themeRadio.checked = true;

                applyTheme(savedTheme);
                updateActiveLink(iframe.contentWindow.location.href);

                // Loader sanft ausblenden, sobald der Iframe geladen ist
                contentLoader.classList.add('hidden');
            });

            // Initialen Status setzen
            updateActiveLink(iframe.src);
        });
    </script>
</body>

</html>